function [sumFXYdxdy] = myintegralpdf2D(FXY,xmax,xmin,ymax,ymin,xnbins,ynbins)
%-----------------------------------------------------------------------------------
%COMPUTE THE INTEGRAL UNDER THE PDF SURFACE TO BE SURE THAT IS EQUAL TO ONE:
%-----------------------------------------------------------------------------------
%===================================================================================
%METHOD 1:
%...................................................................................
dx = (xmax-xmin)/(xnbins-1);
dy = (ymax-ymin)/(ynbins-1);
%...................................................................................
dxdy = dx*dy;
%...................................................................................
FXYdxdy = FXY * dxdy;
%...................................................................................
sumFXYdxdy001 = sum(FXYdxdy(:)); %Should be equal to one!
%...................................................................................
%===================================================================================
%METHOD 2:
%-----------------------------------------------------------------------------------
% <http://stackoverflow.com/questions/23688669/how-to-integrate-over-a-discrete-2d-surface-in-matlab>
%-----------------------------------------------------------------------------------
%NOTE: Because the data are uniformly distributed over x-y plane, I can: 
% 1) simply sum up all the f(x,y) values, then 
% 2) multiply the result by the bottom area, and 
% 3) finally divide it by the number of points I have.
%-----------------------------------------------------------------------------------
areaxy = (xmax-xmin)*(ymax-xmin);
nptos  = (xnbins*ynbins);
sumFXY = sum(FXY(:));
%...................................................................................
sumFXYdxdy002 = (sumFXY * areaxy) / nptos; %Should be equal to one!
%...................................................................................
%===================================================================================
% $$$ whos FXY 
% $$$ %...................................................................................
% $$$ sumFXYdxdy001
% $$$ %...................................................................................
% $$$ sumFXYdxdy002
% $$$ %...................................................................................
% $$$ pause 
%===================================================================================
%...................................................................................
sumFXYdxdy = sumFXYdxdy001;
%...................................................................................
% $$$ sumFXYdxdy = sumFXYdxdy002;
%...................................................................................
%===================================================================================
%SHANNON INDEX:
%...................................................................................
FXYlogFXYdxdy = - FXY .* log(FXY) * dxdy;
%...................................................................................
ShannonIndex = sum(FXYlogFXYdxdy(:));
%...................................................................................
%===================================================================================
%***********************************************************************************
return
