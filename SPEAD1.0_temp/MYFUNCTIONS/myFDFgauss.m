function [FDFgauss,deltax]=myFDFgauss(xvarnc,nptos)

%**************************************************
%MY FREQUENCY DISTRIBUTION FUNCTION (FDF) GAUSSIAN:
%**************************************************
%----------------------------------------------------------------------
%sigma = sqrt(0.01*xmax);
%Ygauss = (1/(sigma*sqrt(2*pi))) * exp(-(x-xm).^2/(2*sigma^2));
%----------------------------------------------------------------------

%%%%%%%%%%%%%%%%%
%DEFINE DE XAXIS:
%%%%%%%%%%%%%%%%%
%===================================================
%...................................................
% $$$ xmin=-5;
% $$$ xmax=+5;
%...................................................
xmin=-10;
xmax=+10;
%...................................................
% $$$ xmin=0;
% $$$ xmax=10;
%...................................................
% $$$ xmin=0;
% $$$ xmax=100;
%...................................................
%===================================================
%...................................................
deltax=(xmax-xmin)/(nptos-1);
xaxis=[xmin:deltax:xmax];
xmean=mean(xaxis);
%...................................................
%===================================================

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%GAUSSIAN FREQUENCY DISTRIBUTION FUNCTION:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%---------------------------------------------------
%NOTE: The AREA under the curve must be equal to 1.0
%---------------------------------------------------
%===================================================
%...................................................
% $$$ xvarnc = 0.2; %variance = sigma^2 = 0.2;
%...................................................
% $$$ xvarnc = 1.0; %variance = sigma^2 = 1.0;
%...................................................
% $$$ xvarnc = 5.0; %variance = sigma^2 = 5.0;
%...................................................
% $$$ xvarnc = 0.2*xmax; 
%...................................................
%===================================================
%...................................................
% $$$ xsigma=sqrt(0.2*xmax); %sigma^2=1;
%...................................................
xsigma=sqrt(xvarnc);
%...................................................
%===================================================
%...................................................
beta = 1/(xsigma*sqrt(2*pi));
%...................................................
%===================================================
%...................................................
FDFgauss1 = beta*exp(-(((xaxis-xmean).^2)/(2*xsigma^2)));
%...................................................
FDFgauss2 = beta*exp(-0.5*((xaxis-xmean)/xsigma).^2); %Wikipedia.
%...................................................
%===================================================

%%%%%%%%%%%%%%%%%%%%%%%%%
%NORMALIZED GAUSSIAN FDF:
%%%%%%%%%%%%%%%%%%%%%%%%%
%-----------------------------------------------------
%NOTE: The MAX value of the curve must be equal to 1.0
%-----------------------------------------------------
NFDFgauss1 = FDFgauss1/max(FDFgauss1);
NFDFgauss2 = FDFgauss2/max(FDFgauss2);

%%%%%%%%
%OUTPUT:
%%%%%%%%
% $$$ FDFgauss = FDFgauss1;
FDFgauss = FDFgauss2;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CHECK THAT THE AREA IS EQUAL TO ONE:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%........................
dAreasFDFgauss = deltax.*FDFgauss;
AreaFDFgauss = sum(dAreasFDFgauss)
%........................

%%%%%%%
%PLOTS:
%%%%%%%
%....................
figure(100)
subplot(2,2,1)
plot(xaxis,FDFgauss1,'b-',xaxis,FDFgauss1,'r*')
axis([-inf +inf, 0 1])
grid on
subplot(2,2,2)
plot(xaxis,FDFgauss2,'b-',xaxis,FDFgauss2,'r*')
axis([-inf +inf, 0 1])
grid on
subplot(2,2,3)
plot(xaxis,NFDFgauss1,'k-',xaxis,NFDFgauss1,'r*')
axis([-inf +inf, 0 1])
grid on
subplot(2,2,4)
plot(xaxis,NFDFgauss2,'k-',xaxis,NFDFgauss2,'r*')
axis([-inf +inf, 0 1])
grid on
%....................

