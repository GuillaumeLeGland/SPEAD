function [ysin]=mySinusoidalCurve(Tperiod,dt,tau,tmin,tmax,ymin,ymax,varargin)
%%function [ysin]=mySinusoidalCurve(Wlength,Tperiod,dt,tau,tmin,tmax,ymin,ymax,varargin)

%***********************************************
%Use:
%    
%varargin{1}: type = 'Linear' / 'Quadratic';
%***********************************************
    
%.............................    
type='Linear';
%.............................    
nvarargin=length(varargin);
if nvarargin==1
    type=varargin{1}
end
%.............................    

%%%%%%%%%%%%%%%%%%
%SINUSOIDAL CURVE:
%%%%%%%%%%%%%%%%%%
%========================================================================
%------------------------------------------------------------------------
% <http://en.wikipedia.org/wiki/Sine_wave>
%
% ysin = A*sin(w*t + phi);
%------------------------------------------------------------------------
% (See PLATT etal 2009 ECOMOD):
%
% PARsin = PAR0 * (1 + epsPAR*sin(w*t));
%
% maxPARsin = PAR0*(1 + epsPAR)
% minPARsin = PAR0*(1 - epsPAR)
%------------------------------------------------------------------------
% PAR0 = 100.0;
% epsPAR = 1.0;
%------------------------------------------------------------------------
%========================================================================
%........................................................................
% $$$ Wlength = 1.0; %Wave length.
% $$$ Tperiod = 365; %Period time.
% $$$ tau = Tperiod/2;
% $$$ tmax = Tperiod*4;
% $$$ ymin = 0; %[C]
% $$$ ymax = 1;
% $$$ dt = 1;
%........................................................................
%========================================================================
%........................................................................
Wlength = 1.0; %Wave length.
%........................................................................
% $$$ t = [dt:dt:tmax];
t = [tmin:dt:tmax];
%........................................................................
time = t-tau;
xspace = 0; 
%........................................................................
wrad = (2*pi)/Tperiod;
krad = (2*pi)/Wlength;
%........................................................................
A0 = ymin;
A = (ymax-ymin)/2; %amplitud.
%........................................................................
%========================================================================
%........................................................................
% $$$ ysin = A0 + A*(sin(wrad*time + krad*xspace));
%........................................................................
ysin = A0 + A*(1.0 + sin(wrad*time)); %USAR ESTA!
%........................................................................
% $$$ ysin = A0 + A*sin(wrad*time);
%........................................................................
% $$$ phi = pi %rad.
% $$$ ysin = A*sin(wrad*t + phi);
%........................................................................
% $$$ Area=sum(ysin*dt)
%........................................................................
% $$$ figure(1)
% $$$ plot(t,ysin,'.b-')
%........................................................................
%========================================================================

%%%%%%%%%%%%%%%%%%%
%SQUARE SINUSOIDAL:
%%%%%%%%%%%%%%%%%%%
if strcmp(type,'Quadratic')
%...............................
% $$$ mask = (ysin/ymin).^2 / ymax.^2;
% $$$ %...............................
% $$$ ysin2 = ysin.*mask;
% $$$ %...............................
% $$$ ysin3 = ysin2/max(ysin2);
% $$$ %...............................
% $$$ ysinQuadratic = ymax - 2*A*(ysin3); %nota: OJO!! ymax es en realidad ymin!!
%...............................
% $$$ xsin = (ysin/ymin).^2 / (ymax./ymin).^2;
% $$$ npower=1.5;
% $$$ ysinQuadratic = ymax - 2*A*xsin.^npower;
%...............................
yymin = ymax; %nota: OJO!! ymax es en realidad ymin!!
yymax = ymin;
xsin = (ysin/yymin).^2 / (yymax./yymin).^2;
npower = 1.5;
ysinQuadratic = yymin + 2*(-A)*xsin.^npower; %USAR ESTA!!!!
%...............................

%..............
% $$$ figure(2)
% $$$ plot(t,ysin4,'.b-')
% $$$ pause
%..............

%%%%%%%%
%OUTPUT:
%%%%%%%%
ysin = ysinQuadratic;
end

%*************************************
return 

%....................................................................
Tperiod = 25.00; %[d]
wrad = (2*pi)/Tperiod; 
%....................................................................
tmin = 0;
tmax = 100;
nbin = 100;
tdel = (tmax - tmin) / (nbin - 1);
%....................................................................
tspan = [tmin:tdel:tmax];
%....................................................................
TSPAN = [];
%....................................................................
Beta = 10.0; %[umolN*dm-3]
Alfa = 10.0; %[umolN*dm-3*d-1]
%....................................................................
ysin = (1/2)*(Alfa + Alfa*sin(wrad*tspan));
ycos = (1/2)*(Alfa + Alfa*cos(wrad*tspan));
%....................................................................
ysin = (1/2)*(Alfa + Alfa*sin(wrad*tspan));
ycos = (1/2)*(Alfa + Alfa*cos(wrad*tspan));
%....................................................................
ysin = Alfa*exp(-Beta*(1.0 - sin(wrad*tspan)));
ycos = Alfa*exp(-Beta*(1.0 - cos(wrad*tspan)));
%....................................................................
