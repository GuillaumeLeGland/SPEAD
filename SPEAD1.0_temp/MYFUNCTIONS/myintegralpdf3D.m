function [sumFXYZdxdydz] = myintegralpdf3D(FXYZ,xmax,xmin,ymax,ymin,zmax,zmin,xnbins,ynbins,znbins)
%-----------------------------------------------------------------------------------
%COMPUTE THE INTEGRAL UNDER THE PDF SURFACE TO BE SURE THAT IS EQUAL TO ONE:
%-----------------------------------------------------------------------------------
%===================================================================================
%METHOD 1:
%...................................................................................
dx = (xmax-xmin)/(xnbins-1);
dy = (ymax-ymin)/(ynbins-1);
dz = (zmax-zmin)/(znbins-1);
%...................................................................................
dxdydz = dx*dy*dz;
%...................................................................................
FXYZdxdydz = FXYZ * dxdydz;
%...................................................................................
sumFXYZdxdydz001 = sum(FXYZdxdydz(:)); %Should be equal to one!
%...................................................................................
%===================================================================================
%METHOD 2:
%-----------------------------------------------------------------------------------
% <http://stackoverflow.com/questions/23688669/how-to-integrate-over-a-discrete-2d-surface-in-matlab>
%-----------------------------------------------------------------------------------
%NOTE: Because the data are uniformly distributed over x-y plane, I can: 
% 1) simply sum up all the f(x,y) values, then 
% 2) multiply the result by the bottom area, and 
% 3) finally divide it by the number of points I have.
%-----------------------------------------------------------------------------------
nptos  = (xnbins*ynbins*znbins);
areaxyz = (xmax-xmin)*(ymax-xmin)*(zmax-zmin);
sumFXYZ = sum(FXYZ(:));
%...................................................................................
sumFXYZdxdydz002 = (sumFXYZ * areaxyz) / nptos; %Should be equal to one!
%...................................................................................
%===================================================================================
% $$$ %...................................................................................
% $$$ nptos 
% $$$ %...................................................................................
% $$$ xminmax = [xmin,xmax]
% $$$ yminmax = [ymin,ymax]
% $$$ zminmax = [zmin,zmax]
% $$$ %...................................................................................
% $$$ sumFXYZdxdydz001
% $$$ %...................................................................................
% $$$ sumFXYZdxdydz002
% $$$ %...................................................................................
% $$$ pause
%===================================================================================
%...................................................................................
sumFXYZdxdydz = sumFXYZdxdydz001;
%...................................................................................
% $$$ sumFXYZdxdydz = sumFXYZdxdydz002;
%...................................................................................
%===================================================================================
%SHANNON INDEX:
%...................................................................................
FXYZlogFXYZdxdydz = - FXYZ .* log(FXYZ) * dxdydz;
%...................................................................................
ShannonIndex = sum(FXYZlogFXYZdxdydz(:));
%...................................................................................
%===================================================================================
%***********************************************************************************
return
