function [ESDave,ESDstd] = mygeometricmean(phy,ESDphy) 

%========================================================================
%WEIGHTING FUNCTION: 
%........................................................................
phytot = sum(phy);
%........................................................................
phypcnt = phy./phytot;
%........................................................................
%========================================================================
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%ARITHMETIC WEIGHTED MEAN AND VARIANCE: %OKAY 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%------------------------------------------------------------------------
% <https://en.wikipedia.org/wiki/Weighted_arithmetic_mean> 
%------------------------------------------------------------------------
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%GEOMETRIC MEAN AND VARIANCE: ---> WRONG!!!! (CHANGE THE FUNCTION NAME!!!!)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%========================================================================
%........................................................................
ESDweighted = phypcnt .* ESDphy; 
ESDgeomean = sum(ESDweighted); %Geometric mean. 
ESDdispersion = phypcnt .* (ESDphy - ESDgeomean).^2; 
%........................................................................
ESDvariance = sum(ESDdispersion); 
ESDsigma = sqrt(ESDvariance); 
%........................................................................
%========================================================================
%OUTPUTS: 
%........................................................................
ESDave = ESDgeomean; 
ESDstd = ESDsigma; 
%........................................................................
%========================================================================
%************************************************************************
return


