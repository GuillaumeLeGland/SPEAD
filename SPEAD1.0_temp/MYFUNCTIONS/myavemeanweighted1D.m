function [xave,xstd] = myavemeanweighted1D(x,w) 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%ARITHMETIC WEIGHTED MEAN AND VARIANCE: 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%========================================================================
%------------------------------------------------------------------------
% <https://en.wikipedia.org/wiki/Weighted_arithmetic_mean> 
%------------------------------------------------------------------------
%========================================================================
%FOR WEIGHTED VALUES SUMMING UP TO ONE:
%........................................................................
% $$$ if abs(sum(w) - 1.0) > 1d-6 %if the sum of weights is NOT equal to one.
% $$$     error('The sum of all weights must be equal to one!!!')
% $$$ end 
% $$$ %........................................................................
% $$$ xm = sum(w .* x); %weighted mean.
% $$$ %........................................................................
% $$$ xv = sum(w .* (x - xm).^2); %weighted variance.
% $$$ %........................................................................
% $$$ xs = sqrt(xv); %weighted standard deviation.
% $$$ %........................................................................
%========================================================================
%FOR ANY WEIGHTED VALUES:
%........................................................................
xm = sum(w .* x) / sum(w); %weighted mean.
%........................................................................
xv = sum(w .* (x - xm).^2) / sum(w); %weighted variance.
%........................................................................
xs = sqrt(xv); %weighted standard deviation.
%........................................................................
%========================================================================

%%%%%%%%%
%OUTPUTS: 
%%%%%%%%%
%........................................................................
xave = xm;  
xstd = xs; 
%........................................................................
%========================================================================
%************************************************************************
return

