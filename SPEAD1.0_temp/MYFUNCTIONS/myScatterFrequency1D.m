function [XCOOR,PHYMEAN,NPTOS] = myScatterFrequency1D(xdata,phydata,nxbins)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%MY METHOD PICO-Y-PALA (FASTER):
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%=================================================
%.................................................
% $$$ %%nxbins = 128;
%.................................................
%=================================================
%.................................................
M = [xdata(:),phydata(:)];
%.................................................
M_sort = sortrows(M,1);
%.................................................
xcoor = M_sort(:,1);
phy   = M_sort(:,2);
%.................................................
%=================================================
%.................................................
XI = xcoor(:)';
%.................................................
msize = numel(XI);
%.................................................
Xmin = min(xcoor);
Xmax = max(xcoor);
%..................................................
%=================================================
%..................................................
XL = linspace(Xmin,Xmax,nxbins);
%..................................................
FXL = [1:nxbins];
%..................................................
FXI = interp1(XL,FXL,XI,'nearest');
%..................................................
%=================================================
%..................................................
XCOOR = ones(1,nxbins)*nan;
%..................................................
NPTOS = ones(1,nxbins)*nan;
%..................................................
phy_ave = ones(msize,1)*nan;
%..................................................
fx_frequency = ones(msize,1)*nan;
%..................................................
Xbins = XL;
%..................................................
for jbin = 1:nxbins
    jbindisplay = jbin; 
    xcoor_j = Xbins(jbin);
    I = find(FXI == jbin);
    nptos = length(I);
    if nptos > 0
	fx_frequency(I) = nptos;
	meanphy = max(phy(I)); 
% $$$ 	meanphy = mean(phy(I)); 
% $$$ 	%%meanphy = median(phy(I)); 
	phy_ave(I) = meanphy; 
	NPTOS(jbin) = nptos;
	PHYMEAN(jbin) = meanphy; 
    end
    XCOOR(jbin) = xcoor_j;
end
%..................................................
%=================================================
%*************************************************
return
